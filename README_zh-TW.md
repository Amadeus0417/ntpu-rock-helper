*Contact: oscar83155@gmail.com* 
*Copyright © 2024 Han-Hsin Lin. All rights reserved.*

# 一、前言
這篇文章旨在簡介 ntpurockhelper 這個專案的功能，不會提到任何技術上的細節，不會寫程式也可以放心觀看。如果你會寫程式，可以去作者的github看更詳細的說明。
# 二、簡介
這是一個用 Google Apps Script 開發的腳本，可以理解成一個平常都在睡的機器人，有三個狀況會喚醒他：
1. 收到社辦租借表單回覆
2. 收到社課/活動表單回覆
3. 每日的例行檢查（見第四點）  
並且，由於例行檢查功能的存在，這個腳本存在一定的自我修復功能。  
只要 Google 現行的政策不變，基本上是可以永久使用的。
舉凡表單、試算表各種檔案被意外刪除的狀況都可以應付。*（除非有人直接把這個腳本刪掉，那可能就沒救了）*  
# 三、主要功能
紀錄練團、個人練習以及取消預約的回覆
判斷是否違反規定（見第六點）
若預約有效，則登記到時間表及紀錄表，並且寄信通知預約者
若預約無效，則登記錯誤訊息到紀錄表，並且寄信通知預約者
統計當學期練團的時數，並匯出為一張試算表
# 四、自我修復功能
這個腳本每天會啟動一次，檢查以下項目：
社辦租借時間表及紀錄表是否存在
社辦租借表單是否存在
社課/活動表單是否存在
確保這些檔案都在雲端硬碟的 ntpurockhelper 這個資料夾內
如果以上的文件有缺失，會自動重新生成缺少的項目並且通知 ntpurock@gmail.com 
如果當天是2/1、7/1、9/1三個日期之一，會做出以下的行為：
統計練團時數並匯出試算表（注意：因應未來可能的練團費用變化，統計表的"E1"儲存格設定上作為每小時收費標準的參考，預設值是20。若未來費用有更改，直接改變"E1"儲存格內的數字就可以算出對應的費用）
產生新學期的社辦租借時間表及紀錄表
寄信到 ntpurock@email.com 通知事件發生
社課/活動表單的功能：
社課：在時間表開放的範圍內，根據選擇的工作日，每周在對應的時段填上社課時間。
活動：提供一個開始時間到結束時間，會把這其中的時段在時間表上全部填滿（例：辦表演時器材不在社辦，可以把無法使用的時間全部用此功能標記）
# 五、注意事項
專案的狀態有變會通知 ntpurock@gmail.com ，記得去看信箱就可以了。
非必要請不要隨意更改紀錄表以及時間表的內容，可能會導致計算錯誤或者腳本無法正常運行。如果遇到相關的錯誤，建議直接把出問題的檔案刪掉，每日的例行檢查會自動建立一個新的。
	（註：只是丟到垃圾筒的話，腳本還是偵測得到檔案，請確保完全刪除）
# 六、現行規則
- 預約練團：
  - 不能預約未開放的日期（a.k.a 時間表上面沒有的日期）
  - 不能預約已經被借走的日期
  - 不能預約當天練團
- 個人練習：
  - 只接受當天的預約
  - 不能預約過去的時間
- 取消預約：
  - 不能取消過去的預約
  - 不能取消不存在的預約
  - 取消練團要提前 12 小時以上
- 注意事項：以上的規則是寫死在程式碼裡面的，有問題請連絡作者。
